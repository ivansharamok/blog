<!DOCTYPE html>
<html>

<head>
    <title>MSDeploy Sitecore installation using SolrCloud with SwitchOnRebuild index</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="keywords" content="MSDeploy Sitecore installation using SolrCloud with SwitchOnRebuild index, solr,installation, sitecore,msdeploy,indexing, Works on my machine" />
    <meta name="description" content="MSDeploy Sitecore installation using SolrCloud with SwitchOnRebuild index, solr,installation, sitecore,msdeploy,indexing, " />
    <meta name="theme-color" content="#2CA6CB"/>
    <link rel="shortcut icon" type="image/x-icon" media="screen" href="http://localhost:4000/favicon.ico" />
    <link rel="canonical" href="http://localhost:4000/2016-12-30/script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/" />
    <link rel="alternate" type="application/rss+xml" title="Works on my machine" href="/feed.xml"  />

    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.bootcss.com/octicons/3.5.0/octicons.min.css" >
    <!-- <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/style.css" /> -->
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/style.css" />
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/highlight.css" />
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/static/css/post.css" />
    
    <!-- Hide resource from search bots for now -->
    <meta name="robots" content="noindex,nofollow">
</head>


<body>

    <header>
        <nav class="navbar navbar-tiffany rectangle" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="http://localhost:4000/">Works on my machine</a>
                    <p class="navbar-text">Notes, thoughts, experiments</p>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        
                        <li>
                        <a href="http://localhost:4000/" class="word-keep"><span class="octicon octicon-book"></span></span>&nbsp;&nbsp;Blog</a>
                        </li>
                        
                        
                        <li>
                            <a href="http://localhost:4000/archive/" class="word-keep"><span class="octicon octicon-repo"></span>&nbsp;&nbsp;Archive</a>
                        </li>
                        
                        
                        
                        
                        <li>
                            <a href="http://localhost:4000/category/" class="word-keep"><span class="octicon octicon-list-unordered"></span>&nbsp;&nbsp;Category</a>
                        </li>
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        
                        <li><a href="#stq=" class="search-button"><span class="octicon octicon-search"></span></a></li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>



<div class="main">
    <div class="container">
        <div class="row">
    <div class="content col-lg-9">
        <div class="sheet post">
          <header>
            <h2>MSDeploy Sitecore installation using SolrCloud with SwitchOnRebuild index</h2>
            <p class="post-meta">
                <span class="octicon octicon-clock"></span> Dec 30, 2016
            </p>
            <p class="post-tag">
                <span><a href="http://localhost:4000/category/#solr"><span class="octicon octicon-list-unordered"></span>&nbsp;solr</a><a href="http://localhost:4000/category/#installation"><span class="octicon octicon-list-unordered"></span>&nbsp;installation</a></span>
                <span>
                    <a class="word-keep" href="http://localhost:4000/tags/#sitecore"><span class="octicon octicon-tag"></span>&nbsp;sitecore</a>
                    
                    <a class="word-keep" href="http://localhost:4000/tags/#msdeploy"><span class="octicon octicon-tag"></span>&nbsp;msdeploy</a>
                    
                    <a class="word-keep" href="http://localhost:4000/tags/#indexing"><span class="octicon octicon-tag"></span>&nbsp;indexing</a>
                    
                </span>
            </p>
          </header>
          <hr class="boundary">
          <article>
            <ul id="markdown-toc">
  <li><a href="#create-custom-sccpl-configurations" id="markdown-toc-create-custom-sccpl-configurations">Create custom SCCPL configurations</a></li>
  <li><a href="#create-config-files-for-sccpl-assembly" id="markdown-toc-create-config-files-for-sccpl-assembly">Create config files for SCCPL assembly</a></li>
  <li><a href="#create-msdeploy-parameters-and-archive-files" id="markdown-toc-create-msdeploy-parameters-and-archive-files">Create MSDeploy parameters and archive files</a></li>
  <li><a href="#create-msdeploy-package" id="markdown-toc-create-msdeploy-package">Create MSDeploy package</a></li>
  <li><a href="#set-msdeploy-parameters" id="markdown-toc-set-msdeploy-parameters">Set MSDeploy parameters</a></li>
  <li><a href="#deploy-sitecore-using-msdeploy-package-and-setparameterxml-file" id="markdown-toc-deploy-sitecore-using-msdeploy-package-and-setparameterxml-file">Deploy Sitecore using MSDeploy package and setParameter.xml file</a></li>
  <li><a href="#copy-licensexml-into-app_data" id="markdown-toc-copy-licensexml-into-app_data">Copy license.xml into /App_Data</a></li>
</ul>

<blockquote>
  <p>This article was written using Sitecore 8.2.1</p>
</blockquote>

<p>This article references resources from <a href="https://dev.sitecore.net/Downloads/Sitecore_Azure_Toolkit/1x/Sitecore_Azure_Toolkit_100.aspx">Sitecore Azure Toolkit</a> to create configuration packages and assemble MSDeploy package.
Refer to blog posts by Bas Lijten to better understand the process of <a href="http://blog.baslijten.com/sitecore-on-azure-create-custom-web-deploy-packages-using-the-sitecore-azure-toolkit/">creating custom configuration pacakages (SCCPL)</a> 
and <a href="http://blog.baslijten.com/use-the-sitecore-azure-toolkit-to-deploy-your-on-premises-environment/">MSDeploy package catered to on-prem installation</a>.</p>

<h2 id="create-custom-sccpl-configurations">Create custom SCCPL configurations</h2>

<p>Refer to <a href="http://blog.baslijten.com/sitecore-on-azure-create-custom-web-deploy-packages-using-the-sitecore-azure-toolkit/">this article</a> for more details on how to create custom SCCPL configurations.</p>
<ul>
  <li>
    <p><code class="highlighter-rouge">Sitecore.OnPrem.Common.sccpl</code> configuration<br />
This configuration adds <code class="highlighter-rouge">/App_Data</code> folder to website root directory and sets Sitecore’s <code class="highlighter-rouge">dataFolder</code> setting to point to it.<br />
<img src="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/Sitecore-onprem-common-folder-structure.PNG" alt="common folder structure" /><br />
<a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/Sitecore.OnPrem.Common.zip">Download</a> example configuration structure for this package.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Solr.DataIndexes.Enabled.sccpl</code> configuration<br />
This configuration contains instructions to disable config files for Lucene <code class="highlighter-rouge">sitecore_core_index</code>, <code class="highlighter-rouge">sitecore_master_index</code>, <code class="highlighter-rouge">sitecore_web_index</code> and enable necessary Solr configs for these indexes.<br />
<img src="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/solr-dataindexes-enabled-config-structure.PNG" alt="" /><br />
<a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/Solr.DataIndexes.Enabled.zip">Download</a> example configuration structure for this package.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">Solr.DataIndexes.SwitchOnRebuild.Enabled.sccpl</code> configuration<br />
This configuration sets Solr SwitchOnRebuild index for data indexes.<br />
<img src="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/solr-dataindexes-switchonrebuild-enabled-config-structure.PNG" alt="structure for switchonrebuild enabled config" /><br />
<a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/Solr.DataIndexes.SwitchOnRebuild.Enabled.zip">Download</a> example configuration structure for this package.</p>
  </li>
  <li><code class="highlighter-rouge">SolrCloud.DataIndexes.Reuse.ScItems.Collection.sccpl</code> configuration<br />
This configuration contains patch config files to set reusable Solr collection <code class="highlighter-rouge">scitems</code> for all data indexes.<br />
<img src="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/solrcloud-dataindexes-reuse-scitems-collection.PNG?raw=true" alt="reuse scitems collection" /><br />
<a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/SolrCloud.DataIndexes.Reuse.ScItems.Collection.zip">Download</a> example configuration structure for this package.
    <blockquote>
      <p>I use scripts to quickly standup SolrCloud instance with <code class="highlighter-rouge">scitems</code> and <code class="highlighter-rouge">scitems_swap</code> collections. That’s why I created a separate SCCPL configuration with hard coded collection names.<br />
Ideally you would set collection names via parameters for your MSDeploy package.</p>
    </blockquote>
  </li>
  <li><code class="highlighter-rouge">Sitecore.Security.SetAdminPassword.sccpl</code> configuration<br />
This configuration includes SQL script to set custom <code class="highlighter-rouge">sitecore\admin</code> user password when you install MSDeploy package.<br />
<img src="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/sitecore-security-setadminpassword.PNG?raw=true" alt="structure for SetSitecoreAdminPassword.sql" /><br />
<a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/Sitecore.Security.SetAdminPassword.zip">Download</a> example configuration structure for this package.
    <blockquote>
      <p>You can get <code class="highlighter-rouge">SetSitecoreAdminPassword.sql</code> file from <code class="highlighter-rouge">Sitecore.Cloud.Security.sccpl</code> package distributed with Sitecore Azure Toolkit.</p>
    </blockquote>
  </li>
</ul>

<h2 id="create-config-files-for-sccpl-assembly">Create config files for SCCPL assembly</h2>

<ul>
  <li><code class="highlighter-rouge">/configs/common.packaging.config.json</code></li>
</ul>

<pre><code class="language-JSON">{
  "sccpls":["Sitecore.OnPrem.Common.sccpl", "Sitecore.Cloud.RoleSpecific_Single.sccpl", "Sitecore.Security.SetAdminPassword.sccpl"]
}
</code></pre>
<blockquote>
  <p>This configuration assumes that you aim to install Sitecore XP on dev local machine. If you use <code class="highlighter-rouge">reporting.apikey</code> setting in /ConnectionStrings.config file, then remove <code class="highlighter-rouge">Sitecore.Cloud.RoleSpecific_Single.sccpl</code> configuration reference.<br />
You can find <code class="highlighter-rouge">Sitecore.Cloud.RoleSpecific_Single.sccpl</code> package in resources of Sitecore Azure Toolkit distribution file.</p>
</blockquote>

<ul>
  <li><code class="highlighter-rouge">/configs/solrcloud.switchonrebuild.config.json</code></li>
</ul>

<pre><code class="language-JSON">{
  "scwdps":[
    {
      "role" : "xp-solrcloud",
      "archiveXml" : "solrcloud.switchonrebuild.archive.xml",
      "parametersXml": "solrcloud.switchonrebuild.parameters.xml",
      "sccpls" : ["Solr.DataIndexes.Enabled.sccpl", "Solr.DataIndexes.SwitchOnRebuild.Enabled.sccpl", "SolrCloud.DataIndexes.Reuse.ScItems.Collection.sccpl"]
    }
  ]
}
</code></pre>

<h2 id="create-msdeploy-parameters-and-archive-files">Create MSDeploy parameters and archive files</h2>

<ul>
  <li><code class="highlighter-rouge">/msdeployxmls/solrcloud.switchonrebuild.parameters.xml</code></li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;parameters&gt;</span>
  ..........
  <span class="nt">&lt;parameter</span> <span class="na">name=</span><span class="s">"Solr Endpoint"</span> <span class="na">description=</span><span class="s">"Sitecore SolrCloud Config"</span> <span class="na">tags=</span><span class="s">"Hidden,NoStore"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;parameterEntry</span> <span class="na">kind=</span><span class="s">"XmlFile"</span> <span class="na">scope=</span><span class="s">"App_Config\\Include\\.ContentSearch\.Solr\.DefaultIndexConfiguration\.config$"</span> <span class="na">match=</span><span class="s">"//settings/setting[@name='ContentSearch.Solr.ServiceBaseAddress']/@value"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/parameter&gt;</span>
<span class="nt">&lt;/parameters&gt;</span>
</code></pre></div></div>
<p><a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/solrcloud.switchonrebuild.parameters.xml">Download</a> complete example parameters.xml file.</p>

<ul>
  <li><code class="highlighter-rouge">/msdeployxmls/solrcloud.switchonrebuild.archive.xml</code></li>
</ul>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;sitemanifest</span> <span class="na">MSDeploy.ObjectResolver.createApp=</span><span class="s">"Microsoft.Web.Deployment.CreateApplicationObjectResolver"</span> <span class="na">MSDeploy.ObjectResolver.dirPath=</span><span class="s">"Microsoft.Web.Deployment.DirPathObjectResolver"</span> <span class="na">MSDeploy.ObjectResolver.filePath=</span><span class="s">"Microsoft.Web.Deployment.FilePathObjectResolver"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;dbDacFx</span> <span class="na">path=</span><span class="s">"Sitecore.Reporting.dacpac"</span> <span class="na">databaseName=</span><span class="s">"Sitecore.Reporting.dacpac"</span> <span class="na">MSDeploy.databaseName=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child2"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span> <span class="na">MSDeploy.MSDeployObjectFlags=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployStreamRelativeFilePath=</span><span class="s">"Sitecore.Reporting.dacpac"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;dbDacFx</span> <span class="na">path=</span><span class="s">"Sitecore.Core.dacpac"</span> <span class="na">databaseName=</span><span class="s">"Sitecore.Core.dacpac"</span> <span class="na">MSDeploy.databaseName=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child3"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span> <span class="na">MSDeploy.MSDeployObjectFlags=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployStreamRelativeFilePath=</span><span class="s">"Sitecore.Core.dacpac"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;dbDacFx</span> <span class="na">path=</span><span class="s">"Sitecore.Master.dacpac"</span> <span class="na">databaseName=</span><span class="s">"Sitecore.Master.dacpac"</span> <span class="na">MSDeploy.databaseName=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child4"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span> <span class="na">MSDeploy.MSDeployObjectFlags=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployStreamRelativeFilePath=</span><span class="s">"Sitecore.Master.dacpac"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;dbDacFx</span> <span class="na">path=</span><span class="s">"Sitecore.Web.dacpac"</span> <span class="na">databaseName=</span><span class="s">"Sitecore.Web.dacpac"</span> <span class="na">MSDeploy.databaseName=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child5"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span> <span class="na">MSDeploy.MSDeployObjectFlags=</span><span class="s">"1"</span> <span class="na">MSDeploy.MSDeployStreamRelativeFilePath=</span><span class="s">"Sitecore.Web.dacpac"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;dbFullSql</span> <span class="na">path=</span><span class="s">"SetSitecoreAdminPassword.sql"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child10"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span><span class="nt">&gt;</span>
    .....
  <span class="nt">&lt;/dbFullSql&gt;</span>
  <span class="nt">&lt;iisApp</span> <span class="na">path=</span><span class="s">"Website"</span> <span class="na">MSDeploy.path=</span><span class="s">"2"</span> <span class="na">MSDeploy.MSDeployLinkName=</span><span class="s">"Child1"</span> <span class="na">MSDeploy.MSDeployKeyAttributeName=</span><span class="s">"path"</span> <span class="na">MSDeploy.MSDeployProviderOptions=</span><span class="s">"..."</span><span class="nt">&gt;</span>
  .....
  <span class="nt">&lt;/iisApp&gt;</span>
<span class="nt">&lt;/sitemanifest&gt;</span>
</code></pre></div></div>
<p><a href="/resources/media/2016-12-30-script-sitecore-installation-using-solrcloud-with-switchonrebuild-index/solrcloud.switchonrebuild.archive.xml">Download</a> complete example archive.xml file.</p>

<h2 id="create-msdeploy-package">Create MSDeploy package</h2>

<p>Assemble MSDeploy package:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">Start</span>-SitecoreAzurePackaging -sitecorePath <span class="s1">'C:\simRepo\Sitecore 8.2 rev. 161115.zip'</span> -destinationFolderPath <span class="s1">'C:\wdps'</span> -cargoPayloadFolderPath <span class="s1">'.\customDeploy\cpls'</span> -commonConfigPath <span class="s1">'.\customDeploy\configs\common.packaging.config.json'</span> -skuConfigPath <span class="s1">'.\customDeploy\configs\solrcloud.switchonrebuild.config.json'</span> -archiveAndParameterXmlPath <span class="s1">'.\customDeploy\msdeployxmls'</span>
</code></pre></div></div>

<h2 id="set-msdeploy-parameters">Set MSDeploy parameters</h2>

<p>Create setParameter.xml file where you specify MSDeploy parameters values:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;parameters&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Application Path"</span> <span class="na">value=</span><span class="s">"tst821"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Sitecore Admin New Password"</span> <span class="na">value=</span><span class="s">"b"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Core Admin Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_core;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Core Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_core;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Master Admin Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_master;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Master Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_master;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Web Admin Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_web;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Web Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_web;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Reporting Admin Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_reporting;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Reporting Connection String"</span> <span class="na">value=</span><span class="s">"Data Source=.\SQLEXPRESS;Initial Catalog=tst821_reporting;Integrated Security=False;User ID=sa;Password=12345"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Analytics Connection String"</span> <span class="na">value=</span><span class="s">"mongodb://localhost:27017/tst821_analytics"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Tracking Live Connection String"</span> <span class="na">value=</span><span class="s">"mongodb://localhost:27017/tst821_tracking_live"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Tracking History Connection String"</span> <span class="na">value=</span><span class="s">"mongodb://localhost:27017/tst821_tracking_history"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Tracking Contact Connection String"</span> <span class="na">value=</span><span class="s">"mongodb://localhost:27017/tst821_tracking_contact"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Build Number"</span> <span class="na">value=</span><span class="s">"5"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;setParameter</span> <span class="na">name=</span><span class="s">"Solr Endpoint"</span> <span class="na">value=</span><span class="s">"http://localhost:8983/solr"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/parameters&gt;</span>
</code></pre></div></div>

<h2 id="deploy-sitecore-using-msdeploy-package-and-setparameterxml-file">Deploy Sitecore using MSDeploy package and setParameter.xml file</h2>

<blockquote>
  <p>Command below assumes that <code class="highlighter-rouge">msdeploy</code> path is added to <code class="highlighter-rouge">Path</code> environment variable.</p>
</blockquote>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>msdeploy -presync:runCommand<span class="o">=</span><span class="s2">"%SYSTEMROOT%\System32\inetsrv\appcmd add apppool /name:tst821 &amp; %SYSTEMROOT%\System32\inetsrv\appcmd add site /name:tst821 /bindings:http://tst821.local:80 /physicalPath:C:\inetpub\wwwroot\tst821\Website &amp; %SYSTEMROOT%\System32\inetsrv\appcmd set app tst821/ /applicationPool:tst821"</span> -source:package<span class="o">=</span><span class="s2">"C:\wdps\Sitecore 8.2 rev. 161115_xp-solrcloud.scwdp.zip"</span> -dest:auto,IncludeAcls<span class="o">=</span><span class="s1">'False'</span> -verb:sync -disableLink:ContentExtension -disableLink:AppPoolExtension -disableLink:CertificateExtension -retryAttempts:2 -setParamFile:<span class="s2">"customDeploy\solrcloud.msdeploy.setParameters.xml"</span>
</code></pre></div></div>

<h2 id="copy-licensexml-into-app_data">Copy license.xml into /App_Data</h2>

<p>Last thing to do is to copy your <code class="highlighter-rouge">license.xml</code> file into <code class="highlighter-rouge">/App_Data</code> folder and you should be good to go.<br />
Keep in mind that this example shows how to configure only 3 data indexes with Solr using SwitchOnRebuild index. If you want to switch all indexes to Solr, add necessary configurations to disable Lucene configs for those indexes and enable corresponding Solr configs.</p>

<blockquote>
  <p>Note<br />
There is a bug in Solr provider in version 8.2.1 which does not allow you to create index collection aliases automatically via <code class="highlighter-rouge">ContentSearch.Solr.EnforceAliasCreation</code> setting.
If you want this feature, use patch <a href="https://github.com/SitecoreSupport/Sitecore.Support.124981">Sitecore.Support.124981</a>.<br />
If you don’t have access to the repo, contact <a href="https://support.sitecore.net/helpdesk/">Sitecore Support</a>.</p>
</blockquote>


          </article>
          <hr class="boundary">
          <div id="post-share">
              <!-- Go to www.addthis.com/dashboard to customize your tools -->
              <div class="addthis_inline_share_toolbox"></div>
          </div>
        </div>
        <div class="pad-min"></div>
        <div id="post-comment" class="sheet post">
            <div id="disqus_thread"></div>
        </div>
    </div>
    <div class="content-navigation col-lg-3">
      <div class="shadow-bottom-center" >
        <div class="content-navigation-toc">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Toc
            </div>
            <div class="content-navigation-list toc"></div>
        </div>
        <div class="content-navigation-tag">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Tags
            </div>
            <div class="content-navigation-list">
                <ul>
                    
                    <li>
                        <a href="http://localhost:4000/tags#sitecore"><span class="octicon octicon-tag"></span>&nbsp;sitecore</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/tags#msdeploy"><span class="octicon octicon-tag"></span>&nbsp;msdeploy</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/tags#indexing"><span class="octicon octicon-tag"></span>&nbsp;indexing</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="content-navigation-related">
            <div class="content-navigation-header">
                <span class="octicon octicon-list-unordered"></span>&nbsp;Related
            </div>
            <div class="content-navigation-list">
                <ul>
                    

                    

                    
                        
                            <li>
                                <a href="http://localhost:4000/2017-11-24/publishing-service-in-docker-container/">Sitecore Publishing Service in Docker Windows Container</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-11-07/run-solr-container-in-azure-kubernetes-cluster/">Run Solr container in Azure Kubernetes cluster (AKS)</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-25/run-your-container-in-azure/">Run your container in Azure</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-24/flexible-solr-container-image-for-sitecore/">Flexible Solr container image for Sitecore</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-09-20/run-solr+ssl-in-docker-container-with-sitecore-indexes/">Run Solr + SSL in Docker container with Sitecore indexes</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-03-30/dedicated-sitecore-processing-instance-for-reportingdb-historic-rebuild/">Dedicated Sitecore processing instance for reporting database historic rebuild</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-01-05/configure-sitecore-indexes-for-centralized-indexing-solution/">Configure Sitecore indexes for centralized indexing solution</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2017-01-04/configure-basicauth-for-solr-provider/">Configure BasicAuthentication for Solr provider with Sitecore</a>
                            </li>
                        
                            <li>
                                <a href="http://localhost:4000/2016-12-10/customize-sitecore-azuretoolkit-deployment/">Customize Sitecore Azure toolkit deployment</a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
      </div>
    </div>
</div>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a24c44d9a3c0d22"></script>
    </div>
    <div class="page-scrollTop" data-toggle="tooltip" data-placement="top" title="Top">
        <a href="javascript:void(0);">
            <div class="arrow"></div>
            <div class="stick"></div>
        </a>
    </div>
</div>

    <footer  class="footnote footnote-tiffany">
        <div class="container">
                <a class="foot-item" href="mailto:" target="_blank"><span class="octicon octicon-mail"></span></a>
                <a class="foot-item" href="https://github.com/ivansharamok" target="_blank"><span class="octicon octicon-mark-github"></span></a>
                <a class="foot-item" href="http://localhost:4000/feed.xml" target="_blank"><span class="octicon octicon-rss"></span></a>
                <!-- <a class="foot-item" href="http://localhost:4000/link/"><span class="octicon octicon-link-external"></span></a> -->
                &nbsp;
                <a href="http://blog.sharamok.com/"><span class="word-keep">&copy; Ivan Sharamok</span></a>
        </div>
        <div class="credit">
            Credit to WakelessDragon for <a href="https://github.com/WakelessDragon/blog">Jekyll site theme</a>.
        </div>
    </footer>
    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="http://localhost:4000/static/js/script.js"></script>
    <script type="text/javascript" src="http://localhost:4000/static/js/post.js"></script>
    


</body>
</html>
